<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Про клуб | Лазертаг</title>
  <!-- Pixel Font -->
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet"/>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { background: #111; color: #fff; font-family: 'Press Start 2P', mono; }
    nav { background: rgba(0,0,0,0.8); display: flex; flex-wrap: wrap; justify-content: center; padding: .75rem; }
    nav a { color: #f39c12; text-decoration: none; margin: .5rem; transition: .2s; }
    nav a.active, nav a:hover { color: #ffd700; }
    canvas { display: block; margin: 1rem auto; background: #000; border: 4px solid #222; }
    .container { text-align: center; padding: 1rem; }
    .container h1 { font-size: 1rem; color: #f39c12; margin-bottom: .5rem; }
    .container p { font-size: .75rem; color: #ccc; }
  </style>
</head>
<body>
  <nav>
    <a href="index.html">М Ліга</a>
    <a href="sunday.html">С Ліга</a>
    <a href="rules.html">Правила</a>
    <a href="about.html" class="active">Про клуб</a>
  </nav>
  <canvas id="battleCanvas" width="400" height="200"></canvas>
  <div class="container">
    <h1>Піксельна арена</h1>
    <p>Поки ми готуємося – спостерігай за епічними боями!</p>
  </div>
<script>
(function(){
  const canvas = document.getElementById('battleCanvas');
  const ctx = canvas.getContext('2d');
  /* Параметри анімації */
  const soldierSize = 10;
  const laserColor = '#f00';
  let state = 0;
  let timer = 0;
  let soldiers = [];
  let lasers = [];

  function PixelSoldier(x,y,dir){ this.x=x; this.y=y; this.dir=dir; this.alive=true; this.blink=0; }
  PixelSoldier.prototype.draw = function(){
    if(!this.alive) return;
    if(this.blink>0){ if(Math.floor(this.blink/5)%2===0) return; this.blink--; }
    ctx.fillStyle = '#0f0';
    ctx.fillRect(this.x,this.y,soldierSize,soldierSize);
  };
  function Laser(x,y,dir){ this.x=x; this.y=y; this.dir=dir; this.alive=true; }
  Laser.prototype.draw = function(){ if(!this.alive) return; ctx.fillStyle=laserColor; ctx.fillRect(this.x,this.y,4,2); };

  function resetBattle(){ soldiers=[]; lasers=[]; timer=0; }
  function spawnSoldier(x,y,dir){ soldiers.push(new PixelSoldier(x,y,dir)); }
  function shoot(s){ lasers.push(new Laser(s.x+ (s.dir>0?soldierSize: -4), s.y+soldierSize/2, s.dir)); }

  function update(){ ctx.clearRect(0,0,canvas.width,canvas.height);
    timer++;
    // State machine
    if(state===0){ // Duel 1
      if(timer===1){ resetBattle(); spawnSoldier(0,80,1); spawnSoldier(390,80,-1); }
      if(timer%30===0) shoot(soldiers[0]);
      if(timer%50===0) shoot(soldiers[1]);
      // move
      soldiers.forEach(s=> s.x += s.dir);
      lasers.forEach(l=> { l.x += l.dir*4; if(l.x<0||l.x>400) l.alive=false; });
      // collision
      lasers.forEach(l=> soldiers.forEach(s=>{
        if(s.alive && l.alive && l.x>=s.x && l.x<=s.x+soldierSize && Math.abs(l.y-s.y)<soldierSize){
          s.blink=20; setTimeout(()=>{ s.alive=false; },400); l.alive=false;
        }
      }));
      if(timer>200){ state=1; timer=0; }
    } else if(state===1){ // Third enters
      if(timer===1){ if(soldiers[0].alive) {} spawnSoldier(200,0,1); }
      soldiers[2].y +=2;
      if(timer===60){ shoot(soldiers[2]); }
      lasers.forEach(l=>{ l.x+=l.dir*4; if(l.x<0||l.x>400) l.alive=false; });
      lasers.forEach(l=> soldiers.forEach(s=>{
        if(s.alive && l.alive && Math.abs(l.x-(s.x+soldierSize/2))<4 && Math.abs(l.y-s.y)<soldierSize){
          s.blink=20; setTimeout(()=>{ s.alive=false; },400); l.alive=false;
        }
      }));
      if(timer>200){ state=2; timer=0; }
    } else if(state===2){ // Duel 2 vs 2
      if(timer===1){ resetBattle(); spawnSoldier(0,50,1); spawnSoldier(0,130,1); spawnSoldier(390,50,-1); spawnSoldier(390,130,-1); }
      if(timer%40===0) soldiers.slice(0,2).forEach(s=> shoot(s));
      if(timer%45===0) soldiers.slice(2).forEach(s=> shoot(s));
      soldiers.forEach(s=> s.x+=s.dir);
      lasers.forEach(l=>{ l.x+=l.dir*4; if(l.x<0||l.x>400) l.alive=false; });
      lasers.forEach(l=> soldiers.forEach(s=>{
        if(s.alive && l.alive && Math.abs(l.x-(s.x+soldierSize/2))<4 && Math.abs(l.y-s.y)<soldierSize){
          s.blink=20; setTimeout(()=>{ s.alive=false; },400); l.alive=false;
        }
      }));
      if(timer>300){ state=3; timer=0; }
    } else if(state===3){ // Final 1 vs 1
      if(timer===1){ const live = soldiers.filter(s=>s.alive); resetBattle(); spawnSoldier(live[0].x,live[0].y,live[0].dir); spawnSoldier(live[1].x,live[1].y,live[1].dir);}      
      if(timer%30===0) shoot(soldiers[0]); if(timer%50===0) shoot(soldiers[1]);
      soldiers.forEach(s=> s.x+=s.dir);
      lasers.forEach(l=>{ l.x+=l.dir*4; if(l.x<0||l.x>400) l.alive=false; });
      lasers.forEach(l=> soldiers.forEach(s=>{
        if(s.alive && l.alive && Math.abs(l.x-(s.x+soldierSize/2))<4 && Math.abs(l.y-s.y)<soldierSize){ s.blink=20; setTimeout(()=>{ s.alive=false; },400); l.alive=false;} }));
      if(timer>200){ state=0; timer=0; }
    }
    soldiers.forEach(s=>s.draw()); lasers.forEach(l=>l.draw());
    requestAnimationFrame(update);
  }
  update();
})();
</script>
</body>
</html>
