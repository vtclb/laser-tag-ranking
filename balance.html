<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>–ë–∞–ª–∞–Ω—Å–µ—Ä –∫–æ–º–∞–Ω–¥</title>
  <link rel="stylesheet" href="balancer.css">
  <link rel="stylesheet" href="styles/balance.css">
  <link rel="stylesheet" href="styles/balance.mobile.css">
  <script
    type="module"
    src="scripts/polyfills.js?v=2025-09-18-9"
  ></script>
</head>
<body class="bal">
  <header>
    <button id="ui-burger"></button>
  </header>
  <div id="ui-panel" class="bal__panel">
    <section class="bal__card">
      <div class="bal__row">
        <select id="league">
            <option value="kids">–ú–æ–ª–æ–¥—à–∞ –ª—ñ–≥–∞</option>
            <option value="sundaygames">–°—Ç–∞—Ä—à–∞ –ª—ñ–≥–∞</option>
          </select>
        <div class="bal__actions">
          <button id="btn-load">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≥—Ä–∞–≤—Ü—ñ–≤</button>
          <input type="text" id="new-nick" placeholder="–ù—ñ–∫">
          <input type="number" id="new-age" placeholder="–í—ñ–∫" min="0">
          <button id="btn-create">–°—Ç–≤–æ—Ä–∏—Ç–∏ –≥—Ä–∞–≤—Ü—è</button>
          <button id="ui-clear-lobby" class="btn--danger">–û—á–∏—Å—Ç–∏—Ç–∏ –ª–æ–±–±—ñ</button>
        </div>
      </div>
    </section>

    <section class="bal__card blc-accordion" id="sec-player-picker">
      <h2 class="bal__acc-head">–í–∏–±—ñ—Ä –≥—Ä–∞–≤—Ü—ñ–≤</h2>
      <div class="bal__acc-body scroll-pane">
        <section id="select-area" class="card hidden">
          <div class="bal__row">
            <input type="text" id="player-search" placeholder="üîç –ü–æ—à—É–∫ –≥—Ä–∞–≤—Ü—è..." autocomplete="off">
            <div class="sort-controls">
              <button id="btn-sort-name">–ê‚Äì–Ø</button>
              <button id="btn-sort-pts">–ó–∞ –±–∞–ª–∞–º–∏ ‚Üì</button>
            </div>
          </div>
          <ul id="select-list" class="list"></ul>
          <div class="actions">
            <button id="btn-add-selected">–î–æ–¥–∞—Ç–∏ —É –ª–æ–±–±—ñ</button>
            <button id="btn-clear-selected">–û—á–∏—Å—Ç–∏—Ç–∏ –≤–∏–±—ñ—Ä</button>
          </div>
        </section>
      </div>
    </section>

    <section class="panel">
      <div class="panel__controls">
        <button type="button" id="mode-auto">–ê–≤—Ç–æ-–±–∞–ª–∞–Ω—Å</button>
        <button type="button" id="mode-manual">–†—É—á–Ω–µ —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è</button>
      </div>
      <small>–û–±–µ—Ä—ñ—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ä–µ–∂–∏–º –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—É –∞–±–æ —Ä—É—á–Ω–∏–π, —â–æ–± –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Å–∫–ª–∞–¥–∏ –∫–æ–º–∞–Ω–¥ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ.</small>
    </section>

    <section class="bal__card blc-accordion open" id="sec-lobby">
      <h2 class="bal__acc-head">–õ–æ–±–±—ñ –¥–Ω—è</h2>
      <div class="bal__acc-body">
        <section id="lobby-area" class="card">
          <div class="add-player">
            <input type="text" id="addPlayerInput" placeholder="–ù—ñ–∫ –≥—Ä–∞–≤—Ü—è">
            <button id="addPlayerBtn">Add</button>
          </div>
          <div class="bal__table-wrap">
            <table class="bal__table table">
              <thead>
                <tr><th>–ù—ñ–∫</th><th>–ë–∞–ª–∏</th><th>–†–∞–Ω–≥</th><th>–ê–±–æ–Ω–µ–º–µ–Ω—Ç</th><th>–ö–ª—é—á</th><th>‚Üí–ö–æ–º–∞–Ω–¥–∞ / ‚úï</th></tr>
              </thead>
              <tbody id="lobby-list"></tbody>
            </table>
          </div>
          <div class="bal__players only-mobile"></div>
          <p class="text-muted">
            –ì—Ä–∞–≤—Ü—ñ–≤: <span id="lobby-count">0</span> |
            –°—É–º–∞: <span id="lobby-sum">0</span> |
            –°–µ—Ä–µ–¥–Ω—ñ–π: <span id="lobby-avg">0</span>
          </p>
          <div class="actions">
            <button id="btn-clear-lobby" class="btn--danger">–û—á–∏—Å—Ç–∏—Ç–∏ –ª–æ–±–±—ñ</button>
          </div>
        </section>
      </div>
    </section>

    <section class="bal__card blc-accordion" id="sec-scenario">
      <h2 class="bal__acc-head">–†–µ–∂–∏–º –≥—Ä–∏</h2>
      <div class="bal__acc-body">
        <section id="scenario-area" class="card hidden">
          <label for="teamsize">–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ–º–∞–Ω–¥:</label>
          <select id="teamsize">
            <option value="2">2 –∫–æ–º–∞–Ω–¥–∏</option>
            <option value="3">3 –∫–æ–º–∞–Ω–¥–∏</option>
            <option value="4">4 –∫–æ–º–∞–Ω–¥–∏</option>
          </select>
          <div class="bal__actions">
            <button id="btn-auto">–ê–≤—Ç–æ-–±–∞–ª–∞–Ω—Å</button>
            <button id="btn-manual">–†—É—á–Ω–µ —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è</button>
          </div>
        </section>
      </div>
    </section>

    <section id="teams-area" class="bal__card grid hidden"></section>

    <section id="arena-select" class="bal__card card hidden">
      <h2>–í–∏–±–µ—Ä—ñ—Ç—å –¥–≤—ñ –∫–æ–º–∞–Ω–¥–∏</h2>
      <div id="arena-checkboxes" class="flex gap-2"></div>
      <div class="actions">
        <button id="btn-start-match" disabled>–ü–æ—á–∞—Ç–∏ –±—ñ–π</button>
      </div>
    </section>

    <section id="arena-area" class="bal__card card hidden">
      <h2>–ê—Ä–µ–Ω–∞: <span id="arena-vs"></span></h2>
      <datalist id="players-datalist"></datalist>
      <div class="field">
        <label for="mvp1">MVP:</label>
        <input id="mvp1" list="players-datalist" required>
      </div>
      <div class="field">
        <label for="mvp2">–°—Ä—ñ–±–Ω–∞ –∑—ñ—Ä–∫–∞:</label>
        <input id="mvp2" list="players-datalist">
      </div>
      <div class="field">
        <label for="mvp3">–ë—Ä–æ–Ω–∑–æ–≤–∞ –∑—ñ—Ä–∫–∞:</label>
        <input id="mvp3" list="players-datalist">
      </div>
      <div class="field">
        <label for="penalty">–®—Ç—Ä–∞—Ñ:</label>
        <input type="text" id="penalty" placeholder="–Ω—ñ–∫1:-10, –Ω—ñ–∫2:-5">
      </div>
      <div id="arena-rounds" class="rounds-grid"></div>
      <div class="actions">
        <button id="btn-save-match" disabled>–ó–±–µ—Ä–µ–≥—Ç–∏ –≥—Ä—É</button>
        <input type="file" id="pdf-upload" accept="application/pdf" class="pdf-input">
        <button id="btn-parse-pdf" disabled>–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ PDF-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
        <button id="btn-clear-arena">–°–∫–∏–Ω—É—Ç–∏ –∞—Ä–µ–Ω—É</button>
      </div>
    </section>

    <section class="bal__card blc-accordion" id="sec-avatar-admin">
      <h2 class="bal__acc-head">–ö–µ—Ä—É–≤–∞–Ω–Ω—è –∞–≤–∞—Ç–∞—Ä–∞–º–∏</h2>
      <section id="avatar-admin" class="card">
        <div class="bal__acc-body">
          <p class="text-muted">–û–±–µ—Ä–∏ –≥—Ä–∞–≤—Ü—è, –∑–∞–≤–∞–Ω—Ç–∞–∂ –π–æ–≥–æ –Ω–æ–≤–∏–π –∞–≤–∞—Ç–∞—Ä —Ç–∞ –ø–µ—Ä–µ–≥–ª—è–Ω—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–µ–¥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º.</p>
          <form class="avatar-form" id="avatar-admin-form">
            <div class="form-field">
              <label for="avatar-nick">–ù—ñ–∫ –≥—Ä–∞–≤—Ü—è</label>
              <input type="text" id="avatar-nick" name="avatar-nick" placeholder="–í–≤–µ–¥–∏ –Ω—ñ–∫ –∞–±–æ ID" autocomplete="off">
            </div>
            <div class="form-field">
              <label for="avatar-file">–§–∞–π–ª –∞–≤–∞—Ç–∞—Ä–∞</label>
              <input type="file" id="avatar-file" name="avatar-file" accept="image/*">
            </div>
            <div class="form-actions">
              <button type="button" id="avatar-upload" disabled>–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∞–≤–∞—Ç–∞—Ä</button>
              <button type="button" id="avatars-refresh">–û–Ω–æ–≤–∏—Ç–∏ –∞–≤–∞—Ç–∞—Ä–∏</button>
            </div>
            <div class="avatar-preview" aria-live="polite">
              <img id="avatar-preview" src="assets/default_avatars/av0.png" alt="–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥ –∞–≤–∞—Ç–∞—Ä–∞" hidden>
            </div>
          </form>
        </div>
      </section>
    </section>
  </div>

  <main class="bal__main"></main>

  <div class="bal__overlay" id="ui-overlay" hidden></div>

  <!-- PDF.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js?v=2025-09-18-9"></script>
  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc =
      'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';
  </script>

  <script src="scripts/toast.js?v=2025-09-18-9"></script>

  <!-- ES-–º–æ–¥—É–ª—ñ -->
  <script>
    // Optional overrides for proxy endpoints (edit if needed)
    // window.PROXY_ORIGIN = 'http://localhost:8787';
    window.GAS_FALLBACK_URL =
      'https://script.google.com/macros/s/AKfycbzhQgbHauvk-ekGVHGRMUnEk-Rt-9M3QI_Jw-bjkRF4jAqpPtXQSDw3BsmivTHdvUY7Gw/exec';
  </script>
  <script type="module" src="./scripts/config.js?v=2025-09-18-9"></script>
  <script type="module" src="scripts/api.js?v=2025-09-18-9"></script>
  <script type="module" src="scripts/pdfParser.js?v=2025-09-18-9"></script>
  <script type="module" src="scripts/sortUtils.js?v=2025-09-18-9"></script>
  <script type="module" src="scripts/balanceUtils.js?v=2025-09-18-9"></script>
  <script type="module" src="scripts/lobby.js?v=2025-09-18-9"></script>
  <script type="module" src="scripts/teams.js?v=2025-09-18-9"></script>
  <script type="module" src="scripts/scenario.js?v=2025-09-18-9"></script>
  <script type="module" src="scripts/arena.js?v=2025-09-18-9"></script>
  <script type="module" src="scripts/avatarAdmin.js?v=2025-09-18-9"></script>
  <script type="module" src="scripts/main.js?v=2025-09-18-9"></script>
  <script type="module">
    import { renderAllAvatars } from './scripts/avatars.client.js?v=2025-09-18-9';
    document.addEventListener('DOMContentLoaded', () => renderAllAvatars());
  </script>
</body>
</html>

