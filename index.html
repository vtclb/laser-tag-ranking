<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–°—Ç–∞—Ä—à–∞ –ª—ñ–≥–∞ | –õ–∞–∑–µ—Ä—Ç–∞–≥</title>
  <!-- –ü—ñ–∫—Å–µ–ª—å–Ω–∏–π —à—Ä–∏—Ñ—Ç -->
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
  <!-- PapaParse –¥–ª—è CSV -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Press Start 2P', monospace;
      background: #111 url('assets/background_marathon.png') no-repeat center/cover;
      color: #fff;
      cursor: url('assets/cursor.png') 4 4, auto;
    }
    nav {
      display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem;
      background: rgba(0, 0, 0, 0.7); padding: 0.75rem;
    }
    nav a {
      color: #f39c12; text-decoration: none; transition: color 0.2s;
    }
    nav a:hover, nav a.active {
      color: #ffd700;
    }
    .container {
      max-width: 1200px; margin: 1rem auto; padding: 0 1rem;
    }
    .test-season,
    .summary {
      text-align: center; margin-bottom: 1rem;
    }
    .test-season {
      color: #f39c12;
    }
    .summary {
      color: #ccc; font-size: 0.9rem;
    }
    .search-box {
      text-align: center; margin-bottom: 1rem;
    }
    .search-box input {
      padding: 0.5rem; width: 100%; max-width: 300px;
      background: rgba(0, 0, 0, 0.5); border: 2px solid #555;
      color: #fff; border-radius: 4px;
    }
    .table-container {
      overflow-x: auto; margin-bottom: 1rem;
    }
    table {
      width: 100%; border-collapse: collapse; min-width: 800px;
      font-size: 0.75rem;
    }
    thead th {
      position: sticky; top: 0; background: #222; color: #f39c12;
      padding: 0.75rem; border-bottom: 2px solid #555;
      z-index: 1;
    }
    th, td {
      padding: 0.5rem; border: 1px solid #444; text-align: center;
    }
    tbody tr:nth-child(odd) {
      background: rgba(255, 255, 255, 0.05);
    }
    tbody tr:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    .show-more {
      display: block; margin: 0 auto; padding: 0.75rem 1.5rem;
      background: #222; color: #f39c12; border: 2px solid #f39c12;
      border-radius: 4px; font-family: 'Press Start 2P', monospace;
      font-size: 0.75rem; text-transform: uppercase;
      box-shadow: 0 0 8px #f39c12;
      cursor: url('assets/cursor.png') 4 4, auto;
      transition: transform 0.2s;
    }
    .show-more:hover {
      transform: scale(1.05);
    }
    .hidden-players { display: none; }
    @media(max-width: 600px) {
      table { min-width: 600px; }
      .show-more { width: 90%; }
    }
  </style>
</head>
<body>
  <nav>
    <a href="index.html">–ú–æ–ª–æ–¥—à–∞ –õ—ñ–≥–∞</a>
    <a href="sunday.html" class="active">–°—Ç–∞—Ä—à–∞ –õ—ñ–≥–∞</a>
    <a href="rules.html">–ü—Ä–∞–≤–∏–ª–∞</a>
    <a href="about.html">–ü—Ä–æ –∫–ª—É–±</a>
  </nav>
  <div class="container">
    <div class="test-season">‚ö†Ô∏è –¶–µ —Ç–µ—Å—Ç–æ–≤–∏–π —Å–µ–∑–æ–Ω. –î–∞–Ω—ñ –º–æ–∂—É—Ç—å –∑–º—ñ–Ω—é–≤–∞—Ç–∏—Å—å.</div>
    <div class="search-box">
      <input type="text" id="searchInput" placeholder="–ü–æ—à—É–∫ –Ω—ñ–∫–Ω–µ–π–º—É‚Ä¶" />
    </div>
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>–ú—ñ—Å—Ü–µ</th>
            <th>–ù—ñ–∫–Ω–µ–π–º</th>
            <th>–†–∞–Ω–≥</th>
            <th>–ë–∞–ª–∏</th>
          </tr>
        </thead>
        <tbody id="ranking-table"></tbody>
      </table>
    </div>
    <button class="show-more" onclick="togglePlayers()">–ü–æ–∫–∞–∑–∞—Ç–∏ –±—ñ–ª—å—à–µ</button>
  </div>
  <script>
    const sheetURL =
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vSzum1H-NSUejvB_XMMWaTs04SPz7SQGpKkyFwz4NQjsN8hz2jAFAhl-jtRdYVAXgr36sN4RSoQSpEN/pub?gid=1286735969&single=true&output=csv";
    let allRows = [];

    function getRank(points) {
      if (points >= 1200) return { rank: "S —Ä–∞–Ω–≥", icon: "üü£" };
      if (points >= 800) return { rank: "A —Ä–∞–Ω–≥", icon: "üî¥" };
      if (points >= 500) return { rank: "B —Ä–∞–Ω–≥", icon: "üü°" };
      if (points >= 200) return { rank: "C —Ä–∞–Ω–≥", icon: "üîµ" };
      return { rank: "D —Ä–∞–Ω–≥", icon: "üü¢" };
    }

    function loadRanking() {
      fetch(sheetURL)
        .then((res) => res.text())
        .then((csv) => {
          const rows = csv.trim().split("\n").slice(1);
          const players = rows
            .map((row) => {
              const cols = row.split(",");
              return { nickname: cols[1], points: parseInt(cols[2], 10) };
            })
            .filter((p) => p.nickname && !isNaN(p.points));
          players.sort((a, b) => b.points - a.points);
          const table = document.getElementById("ranking-table");
          table.innerHTML = "";
          allRows = players.map((p, i) => {
            const { rank, icon } = getRank(p.points);
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td>${i + 1}</td>
              <td>${icon} ${p.nickname}</td>
              <td>${rank}</td>
              <td>${p.points}</td>
            `;
            if (i >= 10) tr.classList.add("hidden-players");
            table.appendChild(tr);
            return tr;
          });
        });
    }

    function togglePlayers() {
      const btn = document.querySelector('.show-more');
      const showing = btn.textContent.includes('–¢–æ–ø-10');
      allRows.forEach((row, idx) => {
        if (idx >= 10) row.style.display = showing ? 'table-row' : 'none';
      });
      btn.textContent = showing ? '–ü–æ–∫–∞–∑–∞—Ç–∏ –±—ñ–ª—å—à–µ' : '–¢–æ–ø-10';
    }
    document.addEventListener('DOMContentLoaded', loadRanking);
  </script>
</body>
</html>
